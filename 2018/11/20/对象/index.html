<!Doctype html>
<html>
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <title>对象 | FE NOTEBOOK 🚀</title>
  
    <link rel="icon" href="/images/favico.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/style/gitalk.css">
  <link rel="stylesheet" href="/style/style.css">
  <script src="/js/gitalk.min.js"></script>
</head>
  <body>
    <header class="header">
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">首页</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">归档</a>
        </li>
      
    </ul>
  </nav>
  <h1 class="pc">FE NOTEBOOK 🚀</h1>
  <h1 class="mobile"><a href="/">FE NOTEBOOK 🚀</a></h1>
  <em>「 学海无涯，没空撩妹！」</em>
</header>
    <main class="main">
      <article class="post">
  <div class="post-title">
    <h2 class="title">对象</h2>
  </div>
  <div class="post-meta">
    <span class="post-time">2018-11-20 17:10:30</span>
    <span class="post-tags">
      
    </span>
    
  </div>
  <div class="post-content">
    <blockquote>
<p><sup>这里是我读<a href="https://wangdoc.com/javascript/" target="_blank" rel="noopener">《阮一峰 JavaScript 教程》</a>做的笔记。</sup></p>
</blockquote>
<p>搞个对象吧，怎么样？😂😂😂。 </p>
<p>对象是一组“键值对”的集合，是一种无序的复合数据集合。</p>
<p>对象的所有键名都是字符串，所以可以不加引号。如果键名是数值，数值会被自动转为字符串。ES 6 中对象的键名可以是 Symbol 值。</p>
<p>如果键名不符号标识符规范，就必须用引号引起来，否则会报错。</p>
<h3 id="表达式还是语句"><a href="#表达式还是语句" class="headerlink" title="表达式还是语句"></a>表达式还是语句</h3><p>对象采用大括号表示，这导致了一个问题：如果行首是一个大括号，它到底是表达式还是语句了？</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123;<span class="attr">foo</span>: <span class="number">123</span>&#125;</span><br></pre></td></tr></table></figure>
<p>JavaScript 引擎读这种代码的时候，会发现可能有两种含义。</p>
<p>第一种可能是，这是一个表达式，表示一个包含 foo 属性的对象</p>
<p>第二种可能是，这是一个语句，表示一个代码区块，里面有一个标签 foo，指向表达式 123</p>
<p>位了避免歧义，JavaScript 引擎的做法是，如果遇到这种情况，无法确定是对象还是代码块，一律解释为代码块。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line">&#123; <span class="built_in">console</span>.log(<span class="number">123</span>) &#125; <span class="comment">// 123</span></span><br></pre></td></tr></table></figure>
<p>上面的语句是一个代码块，而且只有解释为代码块，才能执行。<br>如果要解释为对象，最好在大括号前加上圆括号。因为圆括号的里面，只能是表达式，所以确保大括号只能解释为对象。<br><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">(&#123; <span class="attr">foo</span>: <span class="number">123</span> &#125;) <span class="comment">// 正确</span></span><br><span class="line">(&#123; <span class="built_in">console</span>.log(<span class="number">123</span>) &#125;) <span class="comment">// 报错</span></span><br></pre></td></tr></table></figure></p>
<p>这种差异在 eval 语句（作用是对字符串求值）中反映得最明显。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">'&#123;foo: 123&#125;'</span>) <span class="comment">// 123</span></span><br><span class="line"><span class="built_in">eval</span>(<span class="string">'(&#123;foo: 123&#125;)'</span>) <span class="comment">// &#123;foo: 123&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="属性读取"><a href="#属性读取" class="headerlink" title="属性读取"></a>属性读取</h2><p>键名如果不加引号会被当成变量</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> panda = <span class="string">'pandada'</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  panda: <span class="string">'胖达'</span></span><br><span class="line">&#125;</span><br><span class="line">obj[<span class="string">'panda'</span>] <span class="comment">// "胖达"</span></span><br><span class="line">obj[panda] <span class="comment">// undefined, 因为这个时候是访问的 obj['pandada']</span></span><br></pre></td></tr></table></figure>
<p>如果是数值键名，键名可以不加引号，因为会自动转成字符串</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="number">326</span>: <span class="string">'胖达'</span></span><br><span class="line">&#125;</span><br><span class="line">obj[<span class="number">326</span>] <span class="comment">// "胖达"</span></span><br></pre></td></tr></table></figure>
<p>数值键名不能用点的形式读取</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  <span class="number">326</span>: <span class="string">'胖达'</span></span><br><span class="line">&#125;</span><br><span class="line">obj<span class="number">.326</span> <span class="comment">// 报错</span></span><br></pre></td></tr></table></figure>
<h3 id="查看对像的属性，-Object-keys"><a href="#查看对像的属性，-Object-keys" class="headerlink" title="查看对像的属性， Object.keys"></a>查看对像的属性， Object.keys</h3><p>获取对象全部自带的（不包括继承过来的）可遍历（enumerable）的属性。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  panda: <span class="number">326</span>,</span><br><span class="line">  pandada: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'ppp'</span>, &#123;</span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line">  configurable: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line">obj <span class="comment">// &#123;panda: 326, pandada: 0, ppp: 1&#125;</span></span><br><span class="line"><span class="built_in">Object</span>.keys(obj) <span class="comment">// ['panda', 'pandada']</span></span><br></pre></td></tr></table></figure>
<h3 id="delete-删除对象的属性"><a href="#delete-删除对象的属性" class="headerlink" title="delete 删除对象的属性"></a>delete 删除对象的属性</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  panda: <span class="number">326</span>,</span><br><span class="line">  pandada: <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> obj.pandada</span><br><span class="line">obj.pandada <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">Object</span>.keys(obj) <span class="comment">// ['panda']</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">delete</span> obj.panda</span><br><span class="line">obj.panda <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">Object</span>.keys(obj) <span class="comment">// []</span></span><br></pre></td></tr></table></figure>
<p>删除一个不存在的属性，delete 不报错，而且还返回 true</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">delete</span> obj.panda <span class="comment">// true</span></span><br></pre></td></tr></table></figure>
<p>只有在 delete 不能删除的属性时，会返回 false</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = <span class="built_in">Object</span>.defineProperty(&#123;&#125;, <span class="string">'panda'</span>, &#123;</span><br><span class="line">  value: <span class="number">326</span>,</span><br><span class="line">  configurable: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line">obj.panda <span class="comment">// 326</span></span><br><span class="line"><span class="keyword">delete</span> obj.panda <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>delete 只能删除对象本身的属性，继承过来的属性不可以删除，虽然不可以删除，但依然返回了 true</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">delete</span> obj.toString <span class="comment">// true</span></span><br><span class="line">obj.toString <span class="comment">// function toString() &#123; [native code] &#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="属性是否存在：in-运算符"><a href="#属性是否存在：in-运算符" class="headerlink" title="属性是否存在：in 运算符"></a>属性是否存在：in 运算符</h3><p>in 用来检查对象内是否有某个属性，可以是继承过来的属性，可以是不可遍历的属性，如果有则返回 true 否则 false。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">panda</span>: <span class="number">326</span>&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj, <span class="string">'ppp'</span>, &#123;</span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line">  configurable: <span class="literal">false</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 自带属性 panda</span></span><br><span class="line"><span class="string">'panda'</span> <span class="keyword">in</span> obj <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 继承过来的属性</span></span><br><span class="line"><span class="string">'toString'</span> <span class="keyword">in</span> obj <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 不可遍历的属性</span></span><br><span class="line"><span class="string">'ppp'</span> <span class="keyword">in</span> obj <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 没有的属性</span></span><br><span class="line"><span class="string">'cc'</span> <span class="keyword">in</span> obj <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>in 不能识别属性是继承还是自身的。hasOwnProperty 方法用来判断属性是不是自身的属性。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="string">'toString'</span> <span class="keyword">in</span> obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(obj.hasOwnProperty(<span class="string">'toString'</span>)) <span class="comment">// false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="for…in-遍历属性"><a href="#for…in-遍历属性" class="headerlink" title="for…in 遍历属性"></a>for…in 遍历属性</h3><p>遍历对象的全部包括继承过来的可遍历（enumerable）的属性。</p>
<h3 id="with-语句"><a href="#with-语句" class="headerlink" title="with 语句"></a>with 语句</h3><p>with 语句提供了操作一个对象的属性时，省略对象，直接写属性</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: <span class="number">2</span></span><br><span class="line">  c: <span class="number">3</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">with</span> (obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(a) <span class="comment">// 不用写成 obj.a</span></span><br><span class="line">  <span class="built_in">console</span>.log(b) <span class="comment">// 不用写成 obj.b</span></span><br><span class="line">  <span class="built_in">console</span>.log(c) <span class="comment">// 不用写成 obj.c</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对 with 内进行变量赋值操作时，必须是当前对象已经存在的属性，否则会创造一个当前作用域的全局变量</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;<span class="attr">b</span>: <span class="number">2</span>&#125;</span><br><span class="line"><span class="keyword">with</span> (obj) &#123;</span><br><span class="line">  a = <span class="number">1</span></span><br><span class="line">  b = <span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line">obj.a <span class="comment">// undefined</span></span><br><span class="line">a <span class="comment">// 1</span></span><br><span class="line">obj.b <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>
<p>with 语句并不会创建一个新的作用域，依然在当前作用域。导致绑定对象不明确的问题</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> (obj) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(x)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>单纯从代码看不出来 x 到底是全局变量，还是是 obj 的一个属性。这非常不利于代码的除错和模块化，编译器也无法对这段代码进行优化，只能留到运行时判断，这就拖慢了运行速度。建议不要使用 with 语句，可以考虑用一个临时变量代替 with。</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">with</span> (obj1.obj2.obj3) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(p1 + p2)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 用临时变量代替</span></span><br><span class="line"><span class="keyword">const</span> tmp = obj1.obj2.obj3</span><br><span class="line"><span class="built_in">console</span>.log(tmp.p1 + tmp.p2)</span><br></pre></td></tr></table></figure>

  </div>
  
</article>
    </main>
    <footer>
  <p>&copy; 2019 code.dsphoebe.com <wbr> <a href="http://www.miitbeian.gov.cn/">京ICP备15048606号-1</a></p>
</footer>
  </body>
</html>
