<!Doctype html>
<html>
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <title>File å¯¹è±¡ã€FileList å¯¹è±¡ã€FileReader å¯¹è±¡ | FE ç¬”è®°æœ¬ ğŸš€</title>
  
    <link rel="icon" href="/images/favico.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/bjb/style/gitalk.css">
  <link rel="stylesheet" href="/bjb/style/style.css">
  <script src="/bjb/js/gitalk.min.js"></script>
</head>
  <body>
    <header class="header">
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/bjb/" class="menu-item-link">é¦–é¡µ</a>
        </li>
      
        <li class="menu-item">
          <a href="/bjb/archives" class="menu-item-link">å½’æ¡£</a>
        </li>
      
    </ul>
  </nav>
  <h1 class="pc">FE ç¬”è®°æœ¬ ğŸš€</h1>
  <h1 class="mobile"><a href="/">FE ç¬”è®°æœ¬ ğŸš€</a></h1>
  <em>ã€Œ å­¦æµ·æ— æ¶¯ï¼Œæ²¡ç©ºæ’©å¦¹ï¼ã€</em>
</header>
    <main class="main">
      <article class="post">
  <div class="post-title">
    <h2 class="title">File å¯¹è±¡ã€FileList å¯¹è±¡ã€FileReader å¯¹è±¡</h2>
  </div>
  <div class="post-meta">
    <span class="post-time">2019-05-08 13:20:57</span>
    <span class="post-tags">
      
    </span>
    
  </div>
  <div class="post-content">
    <blockquote>
<p><sup>è¿™é‡Œæ˜¯æˆ‘è¯»<a href="https://wangdoc.com/javascript/" target="_blank" rel="noopener">ã€Šé˜®ä¸€å³° JavaScript æ•™ç¨‹ã€‹</a>åšçš„ç¬”è®°ã€‚</sup></p>
</blockquote>
<p>File ç»§æ‰¿äº† Blob å¯¹è±¡ã€‚æ˜¯ä¸€ç§ç‰¹æ®Šçš„ Blob å¯¹è±¡ï¼Œæ‰€æœ‰å¯ä»¥ä½¿ç”¨ Blob å¯¹è±¡çš„åœºåˆéƒ½å¯ä»¥ä½¿ç”¨å®ƒã€‚æ¯”å¦‚è¡¨å•çš„ä¸Šä¼ æ–‡ä»¶ inputã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> File(array, name [, options])</span><br></pre></td></tr></table></figure>
<ul>
<li>arrayï¼šä¸€ä¸ªæ•°ç»„ï¼Œæˆå‘˜å¯ä»¥æ˜¯äºŒè¿›åˆ¶å¯¹è±¡æˆ–å­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–‡ä»¶çš„å†…å®¹</li>
<li>nameï¼šå­—ç¬¦ä¸²ï¼Œè¡¨ç¤ºæ–‡ä»¶åæˆ–æ–‡ä»¶è·¯å¾„</li>
<li>optionsï¼šå¯é€‰ï¼Œé…ç½®å¯¹è±¡ï¼Œè®¾ç½®å®ä¾‹çš„å±æ€§ã€‚<ul>
<li>typeï¼šè¡¨ç¤ºå®ä¾‹å¯¹è±¡çš„ MIME ç±»å‹ å­—ç¬¦ä¸²ï¼Œé»˜è®¤ä¸ºç©º</li>
<li>lastModifiedï¼šæ—¶é—´æˆ³ï¼Œè¡¨ç¤ºä¸Šæ¬¡ä¿®æ”¹çš„äº‹ä»¶ï¼Œé»˜è®¤ä¸º <code>Date.now()</code></li>
</ul>
</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> f = <span class="keyword">new</span> File(</span><br><span class="line">	[<span class="string">'foo'</span>],</span><br><span class="line">  <span class="string">'foo.txt'</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    type: <span class="string">'text/plain'</span></span><br><span class="line">  &#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>FileList å¯¹è±¡æ˜¯ä¸€ä¸ªç±»ä¼¼æ•°ç»„çš„å¯¹è±¡ï¼Œä»£è¡¨ä¸€ç»„é€‰ä¸­çš„æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶å°±æ˜¯ä¸€ä¸ª File å®ä¾‹ã€‚ä¸»è¦åœºæ™¯ï¼šinput[type=â€fileâ€]ï¼Œæ‹–æ‹‰ä¸€ç»„æ–‡ä»¶æ—¶ï¼Œç›®æ ‡åŒºçš„ DataTransfer.files å±æ€§ï¼Œè¿”å›ä¸€ä¸ª FileList å®ä¾‹ã€‚</p>
<p>FileReader å¯¹è±¡ç”¨äºè¯»å– File å¯¹è±¡æˆ–è€… Blob å¯¹è±¡æ‰€åŒ…å«çš„æ–‡ä»¶å†…å®¹ã€‚</p>
<ul>
<li>FileReader.prototype.error</li>
<li>FileReader.prototype.readyStateï¼šè¯»å–æ–‡ä»¶æ—¶çš„å½“å‰çŠ¶æ€ï¼š0ï¼ŒæœªåŠ è½½è®¤ä¸ºæ•°æ®ï¼›1ï¼Œè¡¨ç¤ºæ­£åœ¨åŠ è½½æ•°æ®ï¼›2ï¼Œè¡¨ç¤ºåŠ è½½å®Œæˆã€‚ä¸ XMLHttpRequeset.readyState çŠ¶æ€ä¸ä¸€æ ·ï¼ŒXMLHttpRequest.readyStateï¼š0ï¼Œä»£ç†è¢«åˆ›å»ºï¼Œè¿˜æ²¡æœ‰è°ƒç”¨ <code>open()</code> æ–¹æ³•ï¼›1ï¼Œ<code>open()</code> æ–¹æ³•å·²ç»è¢«è°ƒç”¨ï¼›2ï¼Œ<code>send()</code> æ–¹æ³•å·²ç»è¢«è°ƒç”¨ï¼Œå¹¶ä¸”å¤´éƒ¨å’ŒçŠ¶æ€å·²ç»å¯è·å¾—ï¼›3ï¼Œä¸‹è½½ä¸­ï¼ŒresponseText å±æ€§å·²ç»åŒ…å«éƒ¨åˆ†æ•°æ®ï¼›4ï¼Œä¸‹è½½æ“ä½œå·²ç»å®Œæˆã€‚</li>
<li>FileReader.prototype.resultï¼šè¯»å–åˆ°çš„æ–‡ä»¶å†…å®¹ï¼Œè¿”å›çš„æ˜¯å­—ç¬¦ä¸²æˆ–è€… ArrayBuffer å®ä¾‹</li>
<li>FileReader.prototype.onabort</li>
<li>FileReader.prototype.onerror</li>
<li>FileReader.prototype.onloadï¼šé€šå¸¸åœ¨è¿™ä¸ªå‡½æ•°é‡Œé¢ä½¿ç”¨ result å±æ€§ï¼Œæ‹¿åˆ°æ–‡ä»¶å†…å®¹</li>
<li>FileReader.prototype.onloadstate</li>
<li>FileReader.prototype.onloadend</li>
<li>FileReader.prototype.onprogress</li>
</ul>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// HTML ä»£ç å¦‚ä¸‹</span></span><br><span class="line"><span class="comment">// &lt;input type="file" onchange="onChange(event)"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> onchange = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> file = e.target.files[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">const</span> reader = <span class="keyword">new</span> FileReader()</span><br><span class="line">  reader.onload = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e.target.result)</span><br><span class="line">  &#125;</span><br><span class="line">  reader.readerAsText(file)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>FileReader.prototype.abort()ï¼šç»ˆæ­¢è¯»å–æ“ä½œï¼ŒreadyState å±æ€§å°†å˜æˆ 2</li>
<li>FileReader.prototype.readAsArrayBuffer()ï¼šä»¥ ArrayBuffer çš„æ ¼å¼è¯»å–æ–‡ä»¶ï¼Œè¯»å–å®Œæˆå result å±æ€§å°†è¿”å›ä¸€ä¸ª ArrayBuffer å®ä¾‹</li>
<li>FileReader.prototype.readAsBinaryString()ï¼šè¯»å–å®Œæˆåï¼Œresult å±æ€§å°†è¿”å›ä¸€ä¸ªäºŒè¿›åˆ¶å­—ç¬¦ä¸²</li>
<li>FileReader.prototype.readAsDataURL()ï¼šè¯»å–å®Œæˆåï¼Œresult å±æ€§è¿”å›ä¸€ä¸ª Data URL æ ¼å¼ï¼ˆBase64 ç¼–ç ï¼‰çš„å­—ç¬¦ä¸²ï¼Œä»£è¡¨æ–‡ä»¶å†…å®¹ã€‚å¯¹äºå›¾ç‰‡æ–‡ä»¶ï¼Œè¿™ä¸ªè‡ªå‘å¯ä»¥ç”¨äº <code>&lt;img&gt;</code> å…ƒç´ çš„ src å±æ€§ã€‚æ³¨æ„è¿™ä¸ªå­—ç¬¦ä¸²ä¸èƒ½ç›´æ¥è¿›è¡Œ Base64 è§£ç ï¼Œå¿…é¡»æŠŠå‰ç¼€ <code>data:*/*;base64,</code> ä»å­—ç¬¦ä¸²åˆ é™¤åï¼Œå†è¿›è¡Œè§£ç </li>
<li>FileReader.readAsText()ï¼šè¯»å–å®Œæˆåï¼Œresult å±æ€§è¿”å›ä¸€ä¸ªæ–‡ä»¶å†…å®¹çš„æ–‡æœ¬å­—ç¬¦ä¸²ã€‚è¯¥æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä»£è¡¨æ–‡ä»¶çš„ Blob å®ä¾‹ï¼Œç¬¬äºŒä¸ªå‚æ•°å¯é€‰ï¼Œè¡¨ç¤ºæ–‡æœ¬ç¼–ç ï¼Œé»˜è®¤æ˜¯ UTF-8.</li>
</ul>

  </div>
  
</article>
    </main>
    <footer>
  <p>&copy; 2019 xcp0326</p>
</footer>
  </body>
</html>
