---
title: å±æ€§æè¿°å¯¹è±¡
category:
date: 2018-11-27 18:37:42
---

> <sup>è¿™é‡Œæ˜¯æˆ‘è¯»[ã€Šé˜®ä¸€å³° JavaScript æ•™ç¨‹ã€‹](https://wangdoc.com/javascript/)åšçš„ç¬”è®°ã€‚</sup>

JavaScript æä¾›äº†ä¸€ä¸ªå†…éƒ¨æ•°æ®ç»“æ„ï¼Œç”¨æ¥æè¿°å¯¹è±¡çš„å±æ€§ï¼Œæ§åˆ¶å®ƒçš„è¡Œä¸ºï¼Œæ¯”å¦‚è¯¥å±æ€§æ˜¯å¦å¯å†™ã€æ˜¯å¦å¯éå†ã€‚è¿™ä¸ªå†…éƒ¨æ•°æ®ç»“æ„ç§°ä¸ºâ€œå±æ€§æè¿°å¯¹è±¡â€ï¼ˆattributes objectï¼‰ã€‚æ¯ä¸ªå±æ€§éƒ½æœ‰è‡ªå·±å¯¹åº”çš„å±æ€§æè¿°å¯¹è±¡ï¼Œä¿å­˜è¯¥å±æ€§çš„ä¸€äº›å…ƒä¿¡æ¯ã€‚

```js
{
	value: undefined,
  writable: true,
  enumerable: true, // å¦‚æœæ˜¯ falseï¼Œfor...in ä¸ Object.keys() å°†å¿½ç•¥è¿™ä¸ªå€¼
  configurable: true, // æ§åˆ¶é™¤äº† value ä»¥å¤–çš„å±æ€§æè¿°å¯¹è±¡çš„å¯å†™æ€§
  get: undefined,// è¯¥å±æ€§çš„å–å€¼å‡½æ•°ï¼Œé»˜è®¤ undefined
  set: undefined // è¯¥å±æ€§çš„å­˜å€¼å‡½æ•°ï¼Œé»˜è®¤ undefined
}
```

Object.getOwnPropertyDescriptor(obj, property) è·å–å¯¹è±¡çš„è‡ªèº«æŸä¸ªå±æ€§çš„å±æ€§æå†™å¯¹è±¡ã€‚

Object.defineProperty(obj, property, attributesObject) å®šä¹‰æˆ–ä¿®æ”¹å¯¹è±¡ obj çš„æŸä¸ªå±æ€§ property çš„å±æ€§æå†™å¯¹è±¡ attributesObjectï¼Œè¿”å›å®šä¹‰æˆ–ä¿®æ”¹åçš„å¯¹è±¡ objã€‚

ä¸å…è®¸åŒæ—¶è®¾ç½® value å’Œ getï¼Œå°±æ˜¯ undefined éƒ½ä¸è¡Œï¼Œä¸å…è®¸åŒæ—¶è®¾ç½® writable å’Œ getã€‚

```js
var obj = {};

Object.defineProperty(obj, 'p', {
  value: undefined,
  get: undefined
});
// TypeError: Invalid property.
// A property cannot both have accessors and be writable or have a value

Object.defineProperty(obj, 'p', {
  writable: false,
  get: undefined
});
// TypeError: Invalid property descriptor.
// Cannot both specify accessors and a value or writable attribute
```

Object.defineProperty å’Œ Object.defineProperties å‚æ•°é‡Œé¢çš„å±æ€§æè¿°å¯¹è±¡ writableã€configurableã€enumerable å±æ€§çš„é»˜è®¤å€¼éƒ½æ˜¯ falseã€‚

## å…ƒå±æ€§

å…ƒå±æ€§æ˜¯æ§åˆ¶å¯¹è±¡å±æ€§çš„å±æ€§ã€‚

### writable

writable æ˜¯æŒ‡ value å¯å¦ä¿®æ”¹ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚

æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œå¦‚æœ writable ä¸º falseï¼Œä¿®æ”¹å¯¹è±¡çš„å±æ€§å€¼æ—¶ï¼Œä¼šé»˜é»˜å¤±è´¥ï¼Œä¸ä¼šæœ‰æŠ¥é”™ã€‚ä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŠ¥é”™ã€‚

å¦‚æœåŸå‹å¯¹è±¡çš„æŸä¸ªå±æ€§çš„ writable æ˜¯ falseï¼Œå®ƒçš„å­å¯¹è±¡ä¼šç»§æ‰¿è¿™ä¸ªå…ƒå±æ€§ï¼Œå­å¯¹è±¡å°†æ— æ³•è‡ªå®šä¹‰è¿™ä¸ªå±æ€§ã€‚ä¸è¿‡å¯ä»¥é€šè¿‡è¦†ç›–å±æ€§æè¿°å¯¹è±¡ï¼Œç»•è¿‡è¿™ä¸ªé™åˆ¶ã€‚

```js
var proto = Object.defineProperty({}, 'foo', {
  value: 'a',
  writable: false
});

var obj = Object.create(proto);
obj.foo = 'b';
obj.foo // "a" å­å¯¹è±¡æ— æ³•ä¿®æ”¹ foo å€¼ï¼Œå› ä¸º foo å€¼åœ¨ proto å¯¹è±¡é‡Œé¢è®¾ç½®äº† writable ä¸º false

Object.defineProperty(obj, 'foo', {
  value: 'b'
});
obj.foo // "b" å†å®šä¹‰ä¸€ä¸ªå­å¯¹è±¡ obj çš„å±æ€§æè¿°å¯¹è±¡æŠŠ proto çš„å±æ€§æè¿°å¯¹è±¡è¦†ç›–äº†ï¼Œåˆå¯ä»¥ä¿®æ”¹ foo å€¼äº†...
```

### enumrable

enumerable æ˜¯æŒ‡ value æ˜¯å¦å¯éå†çš„ï¼Œè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼ã€‚

æ—©æœŸç‰ˆæœ¬çš„ JavaScriptï¼Œfor...in æ˜¯åŸºäº in è¿ç®—ç¬¦çš„ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œin è¿ç®—ç¬¦ä¸ç®¡æŸä¸ªå±æ€§æ˜¯å¯¹è±¡è‡ªèº«çš„è¿˜æ˜¯ç»§æ‰¿çš„ï¼Œéƒ½ä¼šè¿”å› trueã€‚åæ¥å¼•å…¥å¯éå†æ€§è¿™ä¸ªæ¦‚å¿µï¼Œåªæœ‰å¯ä»¥éå†çš„å±æ€§æ‰èƒ½è¢« for...in å¾ªç¯éå†åˆ°ï¼ŒåŒæ—¶è¿˜è§„å®šäº† toString è¿™ä¸€ç±»å®ä¾‹å¯¹è±¡ç»§æ‰¿çš„åŸç”Ÿå±æ€§éƒ½æ˜¯ä¸å¯éå†çš„ã€‚

å¦‚æœä¸€ä¸ªå±æ€§çš„ enumrable ä¸º falseï¼Œfor...in å¾ªç¯ï¼ŒObject.keys æ–¹æ³•ï¼ŒJSON.stringify æ–¹æ³•éƒ½ä¸ä¼šæ¸ é“è¯¥å±æ€§ã€‚

å¯ä»¥ç”¨ enumrable æ¥è®¾ç½®ç§˜å¯†å±æ€§ã€‚ä¸æ˜¯çœŸæ­£çš„ç§æœ‰å±æ€§ï¼Œè¿˜æ˜¯å¯ä»¥ç›´æ¥è·å–åˆ°å®ƒçš„å€¼çš„ã€‚

 for...in å¾ªç¯åŒ…æ‹¬ç»§æ‰¿æ¥çš„å±æ€§ï¼ŒObject.keys æ–¹æ³•ä¸åŒ…æ‹¬ç»§æ‰¿æ¥çš„å±æ€§ã€‚å¦‚æœéœ€è¦è·å–å¯¹è±¡è‡ªèº«çš„æ‰€æœ‰å±æ€§ï¼ŒåŒ…æ‹¬ä¸å¯éå†çš„å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ Object.getOwnPropertyNames æ–¹æ³•ã€‚

JSON.stringify æ–¹æ³•ä¼šæ’é™¤ enumrable ä¸º false çš„å±æ€§ï¼Œæœ‰æ—¶å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹ã€‚å¦‚æœå¯¹è±¡çš„ JSON æ ¼å¼è¾“å‡ºè¦æ’é™¤æŸäº›å±æ€§ï¼Œå°±å¯ä»¥ç›´æ¥è®¾ç½® enumerable ä¸º falseã€‚

### configurable

configurable æ˜¯æŒ‡å±æ€§æè¿°å¯¹è±¡æ˜¯å¦å¯ä»¥ä¿®æ”¹ã€‚ä¹Ÿå°±æ˜¯è¯´ configurable ä¸º falseæ—¶ï¼Œvalueã€writableã€enumrable å’Œ configurable å°±éƒ½ä¸å¯ä»¥ä¿®æ”¹å•¦ã€‚ä¿®æ”¹æ—¶ä¼šæŠ¥é”™ã€‚

```js
var obj = Object.defineProperty({}, 'p', {
  value: 1,
  writable: false,
  enumerable: false,
  configurable: false
});

Object.defineProperty(obj, 'p', {value: 2})
// TypeError: Cannot redefine property: p

Object.defineProperty(obj, 'p', {writable: true})
// TypeError: Cannot redefine property: p

Object.defineProperty(obj, 'p', {enumerable: true})
// TypeError: Cannot redefine property: p

Object.defineProperty(obj, 'p', {configurable: true})
// TypeError: Cannot redefine property: p
```

writable å¦‚æœæ˜¯ falseï¼Œå°±ä¸èƒ½æ”¹ä¸º true äº†ã€‚

writable å’Œ configurable åªè¦æœ‰ä¸€ä¸ªä¸º trueï¼Œå°±å¯ä»¥ä¿®æ”¹ valueã€‚

writable ä¸º falseï¼Œconfigurable ä¸º trueï¼Œç›´æ¥èµ‹å€¼å±æ€§å€¼ä¸æˆåŠŸä½†ä¹Ÿä¸æŠ¥é”™ã€‚

```js
var o2 = Object.defineProperty({}, 'p', {
  value: 1,
  writable: false,
  configurable: true
});

Object.defineProperty(o2, 'p', {value: 2})
o2.p // 2
o2.p = 5;
o2.p // 2
```

configurable æ§åˆ¶å±æ€§æ˜¯å¦å¯ä»¥è¢«åˆ é™¤ã€‚

## å­˜å–å™¨

é™¤äº†ç›´æ¥å®šä¹‰å¤–ï¼Œå±æ€§è¿˜å¯ä»¥ç”¨å­˜å–å™¨ accessor å®šä¹‰ã€‚å…¶ä¸­å­˜å–å‡½æ•°ç§°ä¸º setterï¼Œä½¿ç”¨å±æ€§æè¿°å¯¹è±¡çš„ set å±æ€§ï¼›å–å€¼å‡½æ•°ç§°ä¸º getterï¼Œä½¿ç”¨å±æ€§æè¿°å¯¹è±¡çš„ get å±æ€§ã€‚

ä¸€æ—¦å¯¹ç›®æ ‡å±æ€§å®šä¹‰äº†å­˜å–å™¨ï¼Œé‚£ä¹ˆå­˜å–çš„æ—¶å€™ï¼Œéƒ½å°†æ‰§è¡Œå¯¹åº”çš„å‡½æ•°ã€‚åˆ©ç”¨è¿™ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥å®ç°è®¸å¤šé«˜çº§ç‰¹æ€§ï¼Œæ¯”å¦‚æŸä¸ªå±æ€§ç¦æ­¢èµ‹å€¼ã€‚

```js
var obj = {
  get p() {
    return 'getter';
  },
  set p(value) {
    console.log('setter: ' + value);
  }
};
```

get å‡½æ•°ä¸æ¥å—ä»»ä½•å‚æ•°ï¼Œè€Œ set å‡½æ•°åªæ¥å—ä¸€ä¸ªå‚æ•°ï¼Œå³å±æ€§çš„å€¼ã€‚

## å¯¹è±¡çš„æ‹·è´

ä¼ ç»Ÿçš„æ‹·è´ï¼Œå¦‚æœé‡åˆ°å­˜å–å™¨å®šä¹‰çš„å±æ€§ï¼Œä¼šåªæ‹·è´å€¼ï¼Œå¯ä»¥é€šè¿‡ Object.defineProperty æ–¹æ³•æ¥æ‹·è´å±æ€§

```js
var extend = function(to, from) {
  for (var property in from) {
    if (!from.hasOwnProperty(property)) continue;
    Object.defineProperty(
    	to,
      property,
      Object.getOwnPropertyDescriptor(from, property)
    )
  }
  return to;
} 
extend({}, { get a(){ return 1 } })
// { get a(){ return 1 } })
// ğŸ¤” çœ‹æ¥ Vue ä¼šè¿™ä¹ˆæ¥æ‹·è´å§ï¼Ÿ
```
ä¸Šé¢ä»£ç ä¸­ï¼ŒhasOwnProperty é‚£ä¸€è¡Œç”¨æ¥è¿‡æ»¤æ‰ç»§æ‰¿çš„å±æ€§ï¼Œå¦åˆ™å¯èƒ½ä¼šæŠ¥é”™ï¼Œå› ä¸ºObject.getOwnPropertyDescriptor è¯»ä¸åˆ°ç»§æ‰¿å±æ€§çš„å±æ€§æè¿°å¯¹è±¡ã€‚

## æ§åˆ¶å¯¹è±¡çš„çŠ¶æ€

æœ‰æ—¶éœ€è¦å†»ç»“å¯¹è±¡çš„è¯»å†™çŠ¶æ€ï¼Œé˜²æ­¢å¯¹è±¡è¢«æ”¹å˜ã€‚JavaScript æä¾›ä¸‰ç§å†»ç»“æ–¹æ³•ï¼Œæœ€å¼±çš„ä¸€ç§æ˜¯ Object.preventExtensionsï¼Œå…¶æ¬¡æ˜¯ Object.sealï¼Œæœ€å¼ºçš„æ˜¯ Object.freezeã€‚

Object.preventExtensions æ–¹æ³•å¯ä»¥ä½¿å¾—ä¸€ä¸ªå¯¹è±¡æ— æ³•å†æ·»åŠ æ–°çš„å±æ€§ã€‚Object.isExtensible æ–¹æ³•å¯ä»¥æ£€æµ‹ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä½¿ç”¨äº† Object.preventExtensions æ–¹æ³•ã€‚ä¹Ÿå°±æ˜¯æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯ä»¥æ·»åŠ å¯¹è±¡ã€‚

Object.seal æ–¹æ³•ä½¿å¾—ä¸€ä¸ªå¯¹è±¡æ—¢æ— æ³•æ·»åŠ æ–°å±æ€§ï¼Œä¹Ÿæ— æ³•åˆ é™¤æ—§çš„å±æ€§ã€‚å®è´¨æ˜¯æŠŠå±æ€§æè¿°å¯¹è±¡çš„ configurable å±æ€§è®¾ç½®ä¸ºäº† falseã€‚ä½†æ˜¯ä¿®æ”¹å¯¹è±¡çš„æŸä¸ªå±æ€§å€¼ï¼Œåˆ™æ˜¯ç”±å±æ€§çš„ writable å†³å®šçš„ã€‚Object.isSealed æ–¹æ³•åˆ™æ˜¯æ£€æŸ¥ä¸€ä¸ªå¯¹è±¡æ˜¯å¦ä½¿ç”¨äº† Object.sealedã€‚å¦‚æœ Object.isSealed æ˜¯è¿”å› trueï¼Œåˆ™ Object.isExtensible æ˜¯ false çš„ã€‚

Object.freeze æ–¹æ³•å¯ä»¥ä½¿å¾—ä¸€ä¸ªå¯¹è±¡æ— æ³•æ·»åŠ æ–°å±æ€§ã€æ— æ³•åˆ é™¤æ—§å±æ€§ã€ä¹Ÿæ— æ³•æ”¹å˜å±æ€§çš„å€¼ï¼Œä½¿å¾—å¯¹è±¡å˜æˆä¸€ä¸ªå¸¸é‡äº†ã€‚æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œä¿®æ”¹ã€åˆ é™¤ã€æ·»åŠ å¯ä»¥æ“ä½œä½†æ˜¯ä¸ä¼šæˆåŠŸä¹Ÿä¸ä¼šæŠ¥é”™ï¼Œè€Œä¸¥æ ¼æ¨¡å¼ä¸‹ä¼šæŠ¥é”™ã€‚Object.isFrozen æ–¹æ³•æ˜¯éªŒè¯å¯¹è±¡æ˜¯å¦è¢«å†»ç»“ï¼Œå¦‚æœ Object.isFrozen æ–¹æ³•è¿”å› trueï¼Œåˆ™ Object.isSealed ä¹Ÿæ˜¯è¿”å› trueï¼ŒObject.isExtensible è¿”å› falseã€‚

ä½†æ˜¯è¿™ä¸‰ä¸ªæ–¹æ³•é”å®šå¯¹è±¡çš„å¯å†™æ€§æœ‰ä¸€ä¸ªæ¼æ´ï¼šå¯ä»¥é€šè¿‡æ”¹å˜åŸå‹å¯¹è±¡æ¥ä¸ºå¯¹è±¡å¢åŠ å±æ€§ã€‚

```js
var obj = new Object();
Object.preventExtensions(obj);

var proto = Object.getPrototypeOf(obj);
proto.t = 'hello';
obj.t
// hello
```

ä¸€ç§è§£å†³æ–¹æ¡ˆæ˜¯æŠŠåŸå‹ä¹Ÿå†»ç»“ï¼Œä¸è¿‡å¦‚æœå±æ€§å€¼æ˜¯å¯¹è±¡ï¼Œä¸Šé¢è¿™äº›æ–¹æ³•åªèƒ½å†»ç»“å±æ€§æŒ‡å‘çš„å¯¹è±¡ï¼Œè€Œä¸èƒ½å†»ç»“å¯¹è±¡æœ¬èº«çš„å†…å®¹ã€‚const å£°æ˜ä¸€ä¸ªå¯¹è±¡ä¸ºå¸¸é‡åï¼Œè™½ç„¶ä¸èƒ½ä¿®æ”¹å®ƒå¼•ç”¨çš„ä½ç½®ï¼Œä½†æ˜¯å®ƒçš„å€¼ä½ æ˜¯å¯ä»¥ä¿®æ”¹çš„ï¼Œä¹Ÿå°±æ˜¯è¿™ä¸ªç†äº†ã€‚