<!Doctype html>
<html>
  <head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
  <title>ä»€ä¹ˆæ˜¯ AJAX | FE NOTEBOOK ğŸš€</title>
  
    <link rel="icon" href="/images/favico.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/style/gitalk.css">
  <link rel="stylesheet" href="/style/style.css">
  <script src="/js/gitalk.min.js"></script>
</head>
  <body>
    <header class="header">
  <nav class="navbar">
    <ul class="menu">
      
        <li class="menu-item">
          <a href="/" class="menu-item-link">é¦–é¡µ</a>
        </li>
      
        <li class="menu-item">
          <a href="/archives" class="menu-item-link">å½’æ¡£</a>
        </li>
      
    </ul>
  </nav>
  <h1 class="pc">FE NOTEBOOK ğŸš€</h1>
  <h1 class="mobile"><a href="/">FE NOTEBOOK ğŸš€</a></h1>
  <em>ã€Œ å­¦æµ·æ— æ¶¯ï¼Œæ²¡ç©ºæ’©å¦¹ï¼ã€</em>
</header>
    <main class="main">
      <article class="post">
  <div class="post-title">
    <h2 class="title">ä»€ä¹ˆæ˜¯ AJAX</h2>
  </div>
  <div class="post-meta">
    <span class="post-time">2019-01-15 16:29:55</span>
    <span class="post-tags">
      
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/AJAX/">AJAX</a></li></ul>
      
    </span>
    
  </div>
  <div class="post-content">
    <h3 id="å¦‚ä½•å‘è¯·æ±‚"><a href="#å¦‚ä½•å‘è¯·æ±‚" class="headerlink" title="å¦‚ä½•å‘è¯·æ±‚"></a>å¦‚ä½•å‘è¯·æ±‚</h3><ul>
<li>form é€šè¿‡ action å‘è¯·æ±‚ï¼Œä¸è¿‡ä¼šæ–°å¼€ä¸€ä¸ªé¡µé¢</li>
<li>a æ ‡ç­¾å¯ä»¥é€šè¿‡ href å‘è¯·æ±‚ï¼Œä¸è¿‡ä¼šåˆ·æ–°é¡µé¢æˆ–è€…æ–°å¼€ä¸€ä¸ªé¡µé¢</li>
<li>img æ ‡ç­¾å¯ä»¥é€šè¿‡ src å‘è¯·æ±‚ï¼Œä¸è¿‡ä¼šè¿”å›ä¸€ä¸ªå›¾ç‰‡</li>
<li>link æ ‡ç­¾å¯ä»¥é€šè¿‡ href å‘è¯·æ±‚ï¼Œä¸è¿‡åªèƒ½ä»¥ CSS å±•ç¤ºç»“æœ</li>
<li>script æ ‡ç­¾å¯ä»¥é€šè¿‡ src å‘è¯·æ±‚ï¼Œé€šè¿‡ SRJ ï¼ˆServer Render JavaScriptï¼‰çš„æ–¹å¼å®ç° JSONPï¼Œä¸è¿‡ä¼šè¿”å›ä¸€ä¸ª scriptã€‚</li>
</ul>
<h3 id="AJAX-æ˜¯å¼‚æ­¥çš„-JavaScript-å’Œ-XML"><a href="#AJAX-æ˜¯å¼‚æ­¥çš„-JavaScript-å’Œ-XML" class="headerlink" title="AJAX æ˜¯å¼‚æ­¥çš„ JavaScript å’Œ XML"></a>AJAX æ˜¯å¼‚æ­¥çš„ JavaScript å’Œ XML</h3><p>ä½¿ç”¨ XMLHttpRequest å‘è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å› XML æ ¼å¼çš„å­—ç¬¦ä¸²ï¼ŒJavaScript è§£æ XML å¹¶æ›´æ–°å±€éƒ¨é¡µé¢ã€‚</p>
<p>XMLHttpRequest çš„ onreadystatechange æ–¹æ³•ï¼ŒreadyStateã€statusã€responseText å±æ€§</p>
<h3 id="ä»-XML-åˆ°-JSON"><a href="#ä»-XML-åˆ°-JSON" class="headerlink" title="ä» XML åˆ° JSON"></a>ä» XML åˆ° JSON</h3><p>ä» XML åˆ° é“æ ¼æ‹‰æ–¯Â·å…‹ç½—å…‹ç¦ç‰¹ï¼ˆå‡ºä¹¦ã€ŠJavaScript è¯­è¨€ç²¾ç²¹ã€‹ï¼‰å‘æ˜çš„æ•°æ®äº¤æ¢è¯­è¨€ JSONã€‚JSON æ˜¯æŠ„è¢­ JSï¼Œä½†æ˜¯æ˜¯ä¸€é—¨æ–°è¯­è¨€ï¼Œè€Œå®ƒçš„ä½œè€…è¿˜å‡ºäº†ä¸€æœ¬ä¹¦ä¸“é—¨è¯´ JS çš„ä¸å¥½çš„åœ°æ–¹ï¼ŒğŸ˜‚ ä»–ä¸ JS ä¹‹çˆ¶ä»æ²¡ä¸€èµ·å‡ºåœºè¿‡ã€‚</p>
<p>JSON vs JS</p>
<ol>
<li>JSON æ²¡æœ‰æŠ„è¢­ function å’Œ undefined</li>
<li>JSON å­—ç¬¦é¦–å°¾å¿…é¡»æ˜¯åŒå¼•å·</li>
</ol>
<table>
<thead>
<tr>
<th>JS</th>
<th>JSON</th>
</tr>
</thead>
<tbody>
<tr>
<td>undefined</td>
<td>æ²¡æœ‰</td>
</tr>
<tr>
<td>null</td>
<td>null</td>
</tr>
<tr>
<td>[â€˜aâ€™, â€˜bâ€™]</td>
<td>[â€œaâ€,â€bâ€]</td>
</tr>
<tr>
<td>function fn() {}</td>
<td>æ²¡æœ‰</td>
</tr>
<tr>
<td>â€˜frankâ€™</td>
<td>â€œfrankâ€</td>
</tr>
<tr>
<td>var a = {}; a.self = a;</td>
<td>æä¸å®šï¼ŒJSON æ²¡æœ‰å˜é‡ï¼Œæ— æ³•å®ç°å¼•ç”¨</td>
</tr>
<tr>
<td><code>{__proto__}</code></td>
<td>æ²¡æœ‰åŸå‹</td>
</tr>
</tbody>
</table>
<p>HTTP response ç¬¬ 4 éƒ¨åˆ†æ°¸è¿œéƒ½æ˜¯å­—ç¬¦ä¸²ï¼ŒAJAX ä¸€èˆ¬è¿”å›ç¬¦åˆ JSON å¯¹è±¡è¯­æ³•çš„å­—ç¬¦ä¸²ã€‚</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest()</span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.readyState === <span class="number">4</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.status &gt;= <span class="number">200</span> &amp;&amp; xhr.status &lt; <span class="number">300</span>) &#123;</span><br><span class="line">			<span class="keyword">var</span> data = xhr.responseText</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="built_in">JSON</span>.parse(data))</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'æˆåŠŸ'</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (xhr.status &gt;= <span class="number">400</span>) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'å¤±è´¥'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸€ä¸ªå¼‚æ­¥çš„ GET è¯·æ±‚</span></span><br><span class="line">xhr.open(<span class="string">'get'</span>, <span class="string">'/xxx'</span>)</span><br><span class="line">xhr.send()</span><br></pre></td></tr></table></figure>
<h3 id="AJAX-çš„åŒæºç­–ç•¥ä¸-CORS-è·¨åŸŸ"><a href="#AJAX-çš„åŒæºç­–ç•¥ä¸-CORS-è·¨åŸŸ" class="headerlink" title="AJAX çš„åŒæºç­–ç•¥ä¸ CORS è·¨åŸŸ"></a>AJAX çš„åŒæºç­–ç•¥ä¸ CORS è·¨åŸŸ</h3><p>form å‘è¯·æ±‚å¯ä»¥è·¨åŸŸï¼Œå› ä¸ºæ˜¯è·³è½¬åˆ°å…¶ä»–é¡µé¢ï¼Œå®ƒæ˜¯ä¸ä¼šä¿®æ”¹é¡µé¢é‡Œé¢çš„å†…å®¹ã€‚ä½†æ˜¯ AJAX ä¸å¯ä»¥ï¼å› ä¸º AJAX ä¸ä¼šè·³è½¬ï¼Œå®ƒæ˜¯å¯ä»¥ä¿®æ”¹é¡µé¢é‡Œé¢çš„å…ƒç´ çš„ã€‚</p>
<p>åŒæºç­–ç•¥ï¼šåè®® + åŸŸå + ç«¯å£ ä¸€æ¨¡ä¸€æ ·æ‰å…è®¸å‘ AJAX è¯·æ±‚</p>
<p>è®¾ç½® Access-Cross-Allow-Origin ä¸ºå…¶ä»–åŸŸåï¼Œå°±å¯ä»¥è®©å…¶ä»–åŸŸåè®¿é—®å½“å‰æœåŠ¡å™¨çš„æ•°æ®ã€‚</p>
<p>Cross Origin Resource Sharing è·¨ç«™èµ„æºå…±äº« CORS</p>
<h3 id="JS-æ“ä½œè¯·æ±‚ä¸å“åº”"><a href="#JS-æ“ä½œè¯·æ±‚ä¸å“åº”" class="headerlink" title="JS æ“ä½œè¯·æ±‚ä¸å“åº”"></a>JS æ“ä½œè¯·æ±‚ä¸å“åº”</h3><p>JS å¯ä»¥è®¾ç½®ä»»æ„è¯·æ±‚çš„ header</p>
<ul>
<li>è®¾ç½®è¯·æ±‚ header çš„ç¬¬ä¸€éƒ¨åˆ† xhr.open(â€˜GETâ€™, â€˜/xxxâ€™)</li>
<li>è®¾ç½®è¯·æ±‚ header çš„ç¬¬äºŒéƒ¨åˆ† xhr.setHeader(â€˜content-typeâ€™, â€˜x-www-form-urlencodedâ€™)</li>
<li>è®¾ç½®è¯·æ±‚ header çš„ç¬¬å››éƒ¨åˆ† xhr.send(â€˜a=1&amp;b=2â€™)</li>
</ul>
<p>JS å¯ä»¥è·å–ä»»æ„å“åº” header</p>
<ul>
<li>è·å–å“åº” header çš„ç¬¬ä¸€éƒ¨åˆ† xhr.status / xhr.statusText</li>
<li>è·å–å“åº” header çš„ç¬¬äºŒéƒ¨åˆ† xhr.getResponseHeader() / xhr.getAllResponseHeaders()</li>
<li>è·å–å“åº” header çš„ç¬¬å››éƒ¨åˆ† xhr.responseText</li>
</ul>

  </div>
  
</article>
    </main>
    <footer>
  <p>&copy; 2019 code.dsphoebe.com <wbr> <a href="http://www.miitbeian.gov.cn/">äº¬ICPå¤‡15048606å·-1</a></p>
</footer>
  </body>
</html>
